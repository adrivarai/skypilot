envs:
  MODEL_NAME: meta-llama/Llama-3.2-1B-Instruct
  HF_TOKEN: null # Pass with `--secret HF_TOKEN` in CLI

resources:
  image_id: docker:vllm/vllm-openai:latest
  accelerators: {L4:1, A10G:1, A10:1, A100:1, A100-80GB:1}
  ports:
    - 8000

setup: |
  python3 -c "import huggingface_hub; huggingface_hub.login('${HF_TOKEN}')"


run: |
  echo 'Starting vllm openai api server...'
  vllm serve $MODEL_NAME \
    --port 8000 \
    --dtype auto \
    --tensor-parallel-size $SKYPILOT_NUM_GPUS_PER_NODE
